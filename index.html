<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script src="main.js"></script>
    <title>Chat Window</title>
</head>
<body id="body" onresize="resizeTextarea(document.getElementById('user-text-input'))">
    <div id="reader"></div>
    <script src="./node_modules/html5-qrcode/html5-qrcode.min.js"></script>
    <div id="chat-header">
        <span id="back-button">
            <a class="back-btn" href="https://discoveryworld.org">
            </a>
        </span>
        <span id="download-button">
            <button class="download-btn">
            </button>
        </span>
        <span id="report-button">
            <button class="report-btn">
            </button>
        </span>
    </div>
    <div id="chat-box-window">
    </div>
    <div id="user-text-box">
        <div id="user-text-area">
            <textarea id="user-text-input" oninput="resizeTextarea(this)" onkeypress="textareaKeyPressed(event)" placeholder="Send a message"></textarea>
        </div>
        <div id="prompt-suggestions">
            
        </div>
        <div id="text-box-controls">
            <script>
                async function openQRReader(){
                    const readerDiv = document.getElementById("reader");
                    var html5QrcodeScanner = new Html5QrcodeScanner(
    "reader", { fps: 10, qrbox: 250 });

                    function onScanSuccess(decodedText, decodedResult) {
                        if (decodedText.substr(0,10) == "epic gamer") {
                            generateText(decodedText.substr(10));
                        } else {
                            sendMessage("assistant","[Invalid QR-Code]");
                        };
                        html5QrcodeScanner.clear();
                        readerDiv.remove();
                        document.getElementById("body").innerHTML = "<div id=reader></div>"+ document.getElementById("body").innerHTML
                    };

                    html5QrcodeScanner.render(onScanSuccess);
                    readerDiv.style.zIndex = 98
                };
            </script>
            <div id="send-prompt-button" class="control-buttons" onclick="processPrompt()">
                <button id="send-btn" class="send-pmpt">
                </button>
            </div>
            <div id="voice-dictation" class="control-buttons">
                <button class="voice-dctn">
                </button>
            </div>
            <div id="controls-expander" class="control-buttons" onclick="openQRReader()">
                <button class="controls-expd">
                </button>
            </div>
        </div>
    </div>
</body>
</html>